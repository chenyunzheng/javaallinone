### 生成订单30分钟未支付，则自动取消，该怎么实现？
本质 - 延时任务；
同定时任务相比，非周期

####更简单方案：前端/移动端设置倒计时，30min后触发请求；每次拉起订单进行展示，检查订单状态，再初始化倒计时

1. 数据库扫描
=> 参见`db.ScheduleDBScan`

###优缺点

优点: 简单易行，支持集群操作

缺点:

(1)对服务器内存消耗大

(2)存在延迟，比如你每隔3分钟扫描一次，那最坏的延迟时间就是3分钟

(3)假设你的订单有几千万条，每隔几分钟这样扫描一次，数据库损耗极大

2. JDK延时队列 
=> 参见`jdkdelayqueue.Main`

###优缺点
优点: 效率高, 任务触发时间延迟低。

缺点:

(1)服务器重启后，数据全部消失，怕宕机

(2)集群扩展相当麻烦

(3)因为内存条件限制的原因，比如下单未付款的订单数太多，那么很容易就出现OOM异常

(4)代码复杂度较高

3. 时间轮
   => 参见`timewheel.Main`

###优缺点
优点:效率高,任务触发时间延迟时间比delayQueue低，代码复杂度比delayQueue低。

缺点:

(1)服务器重启后，数据全部消失，怕宕机

(2)集群扩展相当麻烦

(3)因为内存条件限制的原因，比如下单未付款的订单数太多，那么很容易就出现OOM异常

4. Redis缓存
使用ZSet数据结构，score为时间戳

添加元素:ZADD key score member [[score member] [score member] …]
按顺序查询元素:ZRANGE key start stop [WITHSCORES]
查询元素score:ZSCORE key member
移除元素:ZREM key member [member …]

